/*! datajs 2014-09-17 */

function Util(){}function Emiter(){this._events={}}function AOP(){}function DataManager(){}function WatchData(a,b){var c=D.util.clone(a);return this.rawData=D.util.clone(a),this.watchData=null,this.$watch={},this.addWatchData(c,this.rawData,b),this.watchData=c,this.watchData.$rawData=this.rawData,this.watchData.$data=this.watchData,this.watchData.$parent=this.watchData,this.watchData.$root=this.watchData,this.watchData.$index=0,this.watchData.$elem=0,this.watchData.__watch__=!0,this}function Bind(){this.tmpWatchDataProps=[]}function ExpParse(){}var class2type={},core_toString=class2type.toString,core_hasOwn=class2type.hasOwnProperty;"Boolean Number String Function Array Date RegExp Object Error".split(" ").forEach(function(a){class2type["[object "+a+"]"]=a.toLowerCase()}),Util.prototype={constructor:Util,extend:function(a,b){var c=this,d=function(){};return a.superClass?void a.extend(b.prototype):(d.prototype=b.prototype,a.prototype=new d,a.constructor=a,a.superClass=b,a.extend=function(b){c.include(a.prototype,b)},a.prototype.extend=a.extend,a)},include:function(a,b){for(var c in b)a[c]=b[c];return a},clone:function(a){if("object"===this.type(a)&&a.__watch__&&(a=a.$rawData),"object"===this.type(a)){var b={};for(var c in a)b[c]=this.clone(a[c]);return b}if("array"===this.type(a)){for(var d=[],e=0,f=a.length;f>e;e++)d[e]=this.clone(a[e]);return d}return a},array:{},isFunction:function(a){return"function"===this.type(a)},isArray:Array.isArray,isWindow:function(a){return null!=a&&a===a.window},isNumeric:function(a){return!isNaN(parseFloat(a))&&isFinite(a)},type:function(a){return null==a?String(a):"object"==typeof a||"function"==typeof a?class2type[core_toString.call(a)]||"object":typeof a},isPlainObject:function(a){if("object"!==this.type(a)||a.nodeType||this.isWindow(a))return!1;try{if(a.constructor&&!core_hasOwn.call(a.constructor.prototype,"isPrototypeOf"))return!1}catch(b){return!1}return!0},isEmptyObject:function(a){var b;for(b in a)return!1;return!0},getCssPrefix:function(){for(var a=document.body||document.documentElement,b=a.style,c=["webkit","moz","ms","o"],d=0;d<c.length;){if("undefined"!=typeof b[c[d]+"Transition"])return c[d];d++}},getObjectProp:function(a,b){var c=b.split("."),d=null,e=a;return c.forEach(function(a){try{d=e[a],e=d}catch(b){throw console.error("对象属性不存在"),b}}),d},setObjectProp:function(a,b,c){for(var d=b.split("."),e=a,f=0,g=d.length;g>f;f++)try{f!=g-1?e=e[d[f]]:(e[d[f]]=c,"array"===D.util.type(e[d[f]]))}catch(h){throw console.error("对象属性不存在"),h}},placeAt:function(a,b,c){var d=$(a),e=b;c=c||"replaceInner",c=c.toLocaleLowerCase();var f={before:"before",beforebegin:"before",after:"after",afterend:"after",append:"append",afterbegin:"prepend",prepend:"prepend",beforeend:"append",replaceinner:"replaceInner",replace:"replace"};"replace"===c?d.replaceWith(e):"before"===f[c]?d.before(e):"after"===f[c]?d.after(e):"append"===f[c]?d.append(e):"prepend"===f[c]?d.prepend(e):"replaceInner"===f[c]?(d.html(""),d.append(e)):"replace"===f[c]&&d.replaceWith(e)}},Emiter.prototype={constructor:Emiter,trigger:function(a,b,c){this._events=this._events||{};for(var d=this._events[a]=this._events[a]||[],e=0,f=d.length;f>e;e++)d[e].call(this,b,c)},emit:function(){this._events=this._events||{},this.trigger.apply(this,arguments)},on:function(a,b){this._events=this._events||{};var c=this._events[a]=this._events[a]||[];c.push(b)},off:function(a,b){if(this._events=this._events||{},a&&b){for(var c=this._events[a]=this._events[a]||[],d=0,e=c.length;e>d;d++)if(c[d]===b||c[d].CB===b)return void c.splice(d,1)}else a?this._events[a].length=0:this._events={}},once:function(a,b){function c(){d.off(a,b),b.apply(this,arguments)}this._events=this._events||{};var d=this;c.CB=b,this.on(a,c)},one:function(){this._events=this._events||{},this.once.apply(this,arguments)},broadcast:function(){this._events=this._events||{},this.once.apply(this,arguments)},dispatch:function(){this._events=this._events||{},this.once.apply(this,arguments)}};var a=113111111133,b=113111111133,bc=113111111133;AOP.prototype={constructor:AOP,after:function(a,b,c,d){var e=a[b];a[b]=function(){var b=e.apply(d||a,arguments);return c.apply(a,arguments),b},this.include(a[b],e)},before:function(a,b,c,d){var e=a[b];a[b]=function(){var b=c.apply(a,arguments);if(b!==!1)return"[object Array]"===Object.prototype.toString.call(b)?e.apply(d||a,b):e.apply(d||a,arguments)},this.include(a[b],e)},afterThrow:function(a,b,c,d){var e=a[b];a[b]=function(){try{return e.apply(d||a,arguments)}catch(b){var f=Array.prototype.slice.apply(arguments,0);f.unshift(b),c.apply(a,f)}},this.include(a[b],e)},afterFinally:function(a,b,c,d){var e=a[b];a[b]=function(){try{return e.apply(d||a,arguments)}catch(b){throw b}finally{return c.apply(a,arguments)}},this.include(a[b],e)},around:function(a,b,c,d){var e=a[b];a[b]=function(){c.apply(a,arguments);var b=e.apply(d||a,arguments);return c.apply(a,arguments),b},this.include(a[b],e)},introduction:function(a,b,c,d){var e=a[b];a[b]=function(){c.apply(a,arguments);var b=e.apply(d||a,arguments);return b},this.include(a[b],e)},include:function(a,b){for(var c in b)a[c]=b[c];return a}},DataManager.prototype={constructor:DataManager,watchData:function(){},getWatchData:function(){},initData:function(){},getInitData:function(){},_loadViewModel:function(a,b){var c=null;if(D.util.isPlainObject(a))for(var d in a)if(c=a[d],D.util.isPlainObject(c)||D.util.isArray(c)){var e="undefined"==typeof b?d:b+"."+d;this._loadViewModel(c,e)}else this.watchDataObj.watchData[d]=a[d];else D.util.isArray(a)&&(b?D.util.setObjectProp(this.watchDataObj.watchData,b,a):console.error("请求为加载的数据指属性"))},loadData:function(a,b){this._loadViewModel(a,b)},reloadData:function(){},getData:function(){},getSelectedData:function(){},getRawData:function(){},addData:function(){},removeData:function(){},clearData:function(){},updateData:function(a,b){var c=null;if(D.util.isPlainObject(a))for(var d in a)if(c=a[d],D.util.isPlainObject(c)||D.util.isArray(c)){var e="undefined"==typeof b?d:b+"."+d;this.loadData(c,e)}else this.watchDataObj.watchData[d]=a[d];else D.util.isArray(a)&&(b?D.util.setObjectProp(this.watchDataObj.watchData,b,a):console.error("请求为加载的数据指属性"))},reqData:function(a,b,c){1==arguments.length?(c=function(){},b={}):2==arguments.length&&"function"==typeof b&&(c=b,b={}),c=c||function(){},$.get(a,b,function(a){c(a)},"json")},toJS:function(){},toJSON:function(){},toString:function(){},dataReq:function(){},addDataReq:function(a,b,c){this.reqData(a,b,c)},saveDataReq:function(a,b,c){this.reqData(a,b,c)},getDataReq:function(a,b,c){var d=this;1==arguments.length?b={}:2==arguments.length&&"function"==typeof b&&(c=b,b={}),c=c||function(a){d.loadData(a)},this.reqData(a,b,c)},updateDataReq:function(){},removeDataReq:function(){},insert:function(){},update:function(){},"delete":function(){},query:function(){}},function(){function a(b,c){var d=null,e=a.util.clone(b);e.initData||(e={initData:e}),d=e.initData,this.extend(e),c=c||"body",this.container=$(c),this.initData=a.util.clone(d),this.extra={},e.template&&a.util.placeAt(this.container,e.template,e.pos);var f=this.watchDataObj=new WatchData(this.initData),g=new Bind;watchData=f.watchData,f.d=this;var h=[];this.parseElement(this.container,h),this.bindData(h,g,f,this)}a.util=new Util,a.util.extend(a,Emiter),a.extend({parseElement:function(a,b){b=b||[];var c=this,d=$(a)||this.container||$("body"),e=d.data("hasParse");if(!e){var f=this.parseDataBind(d.get(0),b);d.data("hasParse",!0)}f||d.children().each(function(){c.parseElement(this,b)})},parseDataBind:function(a,b){b=b||[];var c=this,d=a.attributes,e="",f={elem:a,bindSyntax:[]},g=f.bindSyntax,h=!1;for(var i in d)d[i].nodeName&&0===d[i].nodeName.indexOf("d-")&&(e=d[i].nodeName.replace("d-",""),val=d[i].nodeValue,h===!1&&"repeat"===e&&(h=!0),e&&val&&(val=c.parseExp(val),g.push("string"==typeof val?{key:e,val:$.trim(val)}:{key:e,val:val})));return g.length>0&&b.push(f),h},parseExp:function(a){for(var b=/((\w):(\w),?)*/g,c=[],d=null,b=/([^,:]+):([\w\W]*?)(,|$)/g;null!=(d=b.exec(a));)c.push({key:$.trim(d[1]),val:$.trim(d[2])});return c.length&&c||a},bindData:function(b,c,d){if(0!==b.length){var e=this;b.forEach(function(b){var f=b.elem;b.bindSyntax.forEach(function(b){var g=b.key,h=b.val;if(c[g])if("string"==typeof h)c[g](h,f,d,e);else{var i=h;switch(g){case"event":case"on":i.forEach(function(a){c[a.key](a.val,f,d,e)});break;case"one":i.forEach(function(a){c[a.key](a.val,f,d,e,!0)});break;case"css":case"style":var j={};h.forEach(function(a){j[a.key]=a.val}),c.style(j,f,d,e);break;case"attr":var k={};h.forEach(function(a){k[a.key]=a.val}),c.attr(k,f,d,e);break;case"class":var l={};h.forEach(function(a){l[a.key]=a.val}),c["class"](l,f,d,e);break;default:if(c[g]){if("array"===a.util.type(h)){var i={};h.forEach(function(a){i[a.key]=a.val}),h=i}c[g](h,f,d,e)}}}})})}}}),a.extend(DataManager.prototype),a.extend({AOP:new AOP}),a.dataBind=function(b,c){return new a(b,c)},window.D=a}(),D.util.extend(WatchData,Emiter),WatchData.prototype.toString=function(){return JSON.stringify(this.watchData)},WatchData.prototype.watch=function(a,b,c,d){var e=this;return function(){if(0===arguments.length)try{1===d&&e.execWatchCB(a,c)}catch(f){throw f}finally{return b[c]}1===arguments.length&&(b[c]=arguments[0],b[c]!=arguments[0]&&(b[c]=arguments[0]),e.execWatchCB(a,c))}},WatchData.prototype.addWatchData=function(a,b,c){var d="";for(d in a)"function"!=typeof a[d]&&"computed"!==d&&-1===d.indexOf("$")&&this.defineProperty(a,d,this.watch(a,b,d,c));a.computed&&this.computedWatchData(a,b,c)},WatchData.prototype.defineProperty=function(a,b,c){Object.defineProperty(a,b,{get:c,set:c})},WatchData.prototype.addComputedWatchData=function(a,b,c){var d=a.watchData,e=a.rawData;this.tmpWatchDataProps=this.findWatchDataProps(e,b),c(),this.tmpWatchDataProps.forEach(function(b){a.addWatchCB(d,null,b,function(){c()})})},WatchData.prototype.computedWatchData=function(a,b,c){var d=this,e=null,f="";if(e=a.computed,delete a.computed,delete b.computed,D.util.isPlainObject(e))for(f in e){var g=e[f],h=g,i=null;a[f]="",b[f]="",D.util.isFunction(g)||(h=g.get,i=g.set),function(c,e){var f=!0;d.addComputedWatchData(d,e,function(){var d=e.call(a);f&&(f=!1,b[c]=d),a[c]=d})}(f,h),this.defineProperty(a,f,this.watch(a,b,f,c)),i&&!function(c,e){d.addWatchCB(a,null,c,function(){e.call(a,b[c])})}(f,i)}},WatchData.prototype.findWatchDataProps=function(a,b){var c=new WatchData(a,1),d=c.watchData,e={},f=[];for(var g in d)!function(a){e[a]={prop:a,CB:function(){f.push(a)}}}(g),c.addWatchCB(d,null,g,e[g].CB);b.call(d,d);for(var g in e)c.removeWatchCB(g,e[g].CB);return c=null,d=null,e=null,f},WatchData.prototype.addOneWatchData=function(){},WatchData.prototype.removeWatchData=function(){},WatchData.prototype.removeOneWatchData=function(){},WatchData.prototype.execWatchCB=function(a,b,c,d){this.trigger(b,c,d)},WatchData.prototype.addWatchCB=function(a,b,c,d){this.on(c,d)},WatchData.prototype.addOneWatchCB=function(a,b,c,d){this.once(c,d)},WatchData.prototype.removeWatchCB=function(a,b){this.off(a,b)},WatchData.prototype.clearWatchCB=function(){this.off()},Bind.prototype={constructor:Bind,visible:function(a,b,c){this.update(c,a,function(a){var c=a?"block":"none";$(b).css("display",c)})},show:function(a,b,c){this.visible(a,b,c)},text:function(a,b,c){this.update(c,a,function(a){$(b).text(a)})},html:function(a,b,c){this.update(c,a,function(a){$(b).html(a)})},"class":function(a,b,c){var d=this;for(var e in a)!function(e){d.update(c,a[e],function(a){var c=$(b);a===!0?c.addClass(e):c.removeClass(e)})}(e)},sdemocode:function(a,b,c,d){var e=this,f=a.value,g=(a.type||"html").replace(/^(\"|\')|(\"|\')$/g,""),h={theme:"night",lineNumbers:!0,matchBrackets:!0,keyMap:"sublime",dragDrop:!0,theme:"eclipse"};switch(g){case"html":h.mode="htmlmixed",h.tabMode="indent";break;case"js":h.mode="javascript";break;case"css":h.mode="css"}this.update(c,f,function(a){$(b).val(a),d&&d.editor&&d.editor[f]&&d.editor[f].getDoc().setValue(a)}),setTimeout(function(){d.editor=d.editor||{},"currPanel"in c.rawData?e.update(c,"currPanel && isShowSdemoEditor",function(a){a!==!0||c.rawData.currPanel!==g||d.editor[g]||(editor=CodeMirror.fromTextArea(b,$.extend({},h)),d.editor[g]=editor)}):(editor=CodeMirror.fromTextArea(b,$.extend({},h)),d.editor[g]=editor)},100)},sdemooutput:function(a,b,c){this.update(c,a,function(a){var d=$('<iframe src="about:blank" frameborder="0" style="width:100%; height:300px;"></iframe>');$(b).html("").append(d),null==d[0].contentWindow?d.load(function(){var b=c.watchData;a="",a+=b.$parent.importFile,a+=b.html,a+="<style>"+b.css+"</style>",a+='<script type="text/javascript">'+b.js+"</script>",this.contentWindow.document.write(a)}):d[0].contentDocument.write(a)})},sdemolistoutput:function(a,b,c){this.update(c,a,function(a){var d=$('<iframe src="about:blank" frameborder="0" style="width:100%; height:300px;"></iframe>');$(b).html("").append(d),null==d[0].contentWindow?d.load(function(){var b=c.watchData;a="",a+=b.importFile,a+=b.html,a+="<style>"+b.css+"</style>",a+='<script type="text/javascript">'+b.js+"</script>",this.contentWindow.document.write(a)}):d[0].contentDocument.write(a)})},copycode:function(a,b,c,d){var e={html:!0,css:!0,js:!0};this.update(c,"isShowSdemoEditor",function(a){a===!0&&($(b).zclip("remove"),$(b).zclip({path:"js/lib/ZeroClipboard.swf",copy:function(){var a="",b=c.watchData;return e[b.currPanel]&&(a=b[b.currPanel]),a},afterCopy:function(){d.updateData({isCopied:!0}),setTimeout(function(){d.updateData({isCopied:!1})},1e3)}}))})},css:function(a,b,c){c.watchData},style:function(a,b,c){c.watchData;$(b).css(a)},attr:function(a,b,c){var d=this;for(var e in a)!function(e){d.update(c,a[e],function(a){$(b).attr(e,a)})}(e)},value:function(a,b,c){$(b).on("change",function(){c.watchData[a]=this.value}),this.update(c,a,function(a){$(b).val(a)})},checked:function(a,b,c){var d=c.watchData,e=d[a],f=$(b);f.prop("checked",e),c.addWatchCB(d,f,a,function(){var b=d[a];f.prop("checked",b)})},disable:function(a,b,c){var d=c.watchData,e=d[a],f=$(b);f.prop("disabled",e),c.addWatchCB(d,f,a,function(){var b=d[a];f.prop("disabled",b)})},enable:function(a,b,c){var d=c.watchData,e=d[a],f=$(b);f.prop("disabled",!e),c.addWatchCB(d,f,a,function(){var b=d[a];f.prop("disabled",!b)})},hasFocus:function(a,b,c){var d=c.watchData,e=d[a],f=$(b),b=f.get(0);e===!0?b.focus():b.blur(),c.addWatchCB(d,f,a,function(){var b=d[a],c=f.get(0);b===!0?c.blur():c.focus()})},options:function(a,b,c){var d=c.watchData,e=d[a],f=$(b),g=(d.optionsText||"text","");e.forEach(function(a){g+='<option value="'+a.value+'">'+a.text+"</option>"}),f.append(g),c.addWatchCB(d,f,a,function(){var b=d[a],c=(f.get(0),d.optionsText||"text","");b.forEach(function(a){c+='<option value="'+a.value+'">'+a.text+"</option>"}),f.append(c)})},optionsText:function(a,b,c){c.watchData},optionsCaption:function(a,b,c){c.watchData},selectedOptions:function(a,b,c){c.watchData},uniqueName:function(a,b,c){c.watchData},submit:function(a,b,c){c.watchData},on:function(a,b,c){c.watchData},one:function(a,b,c){c.watchData},click:function(a,b,c,d){var e=c.watchData,f=(e[a],$(b)),g=d?"addOneWatchCB":"addWatchCB";$(b).off(eventName),$(b).on("click",function(b){c.execWatchCB(e,a,null,b)}),c[g](e,f,a,function(b){e[a].call(c.d,e,b)})},event:function(a,b,c){c.watchData},foreach:function(a,b,c){c.watchData},repeat:function(a,b,c,d){var e=$(b),f=e.parent();this.update(c,a,function(b){f.find(">[d-repeat="+a+"]").remove(),b.forEach(function(a,g){if(!a.__watch__){var h=e.clone();h.data("hasParse",!0);var i=D.dataBind(a,h),j=i.container;i.watchDataObj.watchData.$index=g,i.watchDataObj.watchData.$parent=c.watchData,i.watchDataObj.watchData.$root=c.$root,i.$parentD=d,b[g]=i.watchDataObj.watchData,f.append(j)}}),e.remove()})},repeat_bak:function(a,b,c){var d=c.watchData,e=d[a],f=$(b),g=f.parent();e.forEach(function(){var a=f.clone();g.append(a)}),c.addWatchCB(d,f,a,function(){var b=d[a];b.forEach(function(){var a=f.clone();g.append(a)})})},"if":function(a,b,c){var d=c.watchData,e=$(b),f=d[a],g=e.html();e.html(f===!0?g:""),c.addWatchCB(d,e,a,function(){var b=d[a];e.html(b?g:"")})},ifnot:function(a,b,c){var d=c.watchData,e=$(b),f=d[a],g=e.html();e.html(f===!1?g:""),c.addWatchCB(d,e,a,function(){var b=d[a];e.html(b?"":g)})},"with":function(a,b,c){c.watchData},template:function(a,b,c){c.watchData},createEvalFun:function(a){"object"==typeof a&&(a=JSON.stringify(a));var b='"user strict;"\n';b+='var ____tmp____ = "";\n',b+="with(watchData){\n",b+="try{\n",b+="____tmp____ = "+a+";\n",b+="}catch(e){\n",b+="console.error(e);\n",b+="debugger;\n",b+="}\n",b+="}\n",b+="return ____tmp____;";var c=new Function("watchData",b);return c},createEvalFun2:function(a,b){var c='"user strict;"\n';c+='var ____tmp____ = "";\n',c+="with(watchData){____tmp____ = "+a+";}\n",c+="return ____tmp____;\n";var d=new Function("watchData",c),e=b.findWatchDataProps(b.rawData,d),c='"user strict;"\n';return e&&e.forEach(function(a){c+="var "+a+'= watchData["'+a+'"];\n'}),c+="return "+a+";\n",d=new Function("watchData",c)},update:function(a,b,c){var d=this.createEvalFun(b);a.addComputedWatchData(a,d,function(){var b=d(a.watchData);c(b)})}};var bindProto=Bind.prototype,allEvents=["keyup","keydown","keypress","click","dblclick","mousedown","mouseup","mousemove","mouseover","mouseout","mouseenter","mouseleave"];allEvents.forEach(function(a){bindProto[a]=function(a){return function(b,c,d,e,f){var g=d.watchData,h=(g[b],$(c)),i=f?"addOneWatchCB":"addWatchCB";f?(i="addOneWatchCB",$(c).off(a),$(c).one(a,function(a){d.execWatchCB(g,b,null,a)})):(i="addWatchCB",$(c).off(a),$(c).on(a,function(a){return d.execWatchCB(g,b,null,a),a.preventDefault(),a.stopPropagation(),!1})),d[i](g,h,b,function(a,c){var d=D.util.getObjectProp(g,b);if("function"!=typeof d)throw console.error("此对象没有"+b+"方法"),"此对象没有"+b+"方法";d.call(e.$parentD||e,g,c,e)})}}(a)}),ExpParse.prototype={constructor:ExpParse,parseExp:function(){}};
//# sourceMappingURL=datajs.min.map